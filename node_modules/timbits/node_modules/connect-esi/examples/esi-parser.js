var esi = esi || new Array();
function parseESI(esi_tag) {
	esi.push($(esi_tag).attr('src')); //save src
	jQuery(esi_tag).replaceWith('<div id="esi_' + (esi.length - 1) + '"></div>');
	loadESI(esi.length - 1);
}
function loadESI(esi_id) {
	var esi_base_url = (/^http:\/\//).test(esi[esi_id]) ? '' : ((typeof base_url !== "undefined" && base_url !== null) ? base_url : '');
	PMScriptManager.load(esi_base_url + esi[esi_id] + "&esi_id=esi_" + esi_id + "&remote=true",{force:true});
}
function refreshESI() {
	jQuery(esi).each(function(index){
		loadESI(index);
	});
}
jQuery(document).ready(function() {
	jQuery('esi\\:include').each(function(index){ parseESI(this); });
	jQuery('csi\\:include').each(function(index){ parseESI(this); });
});